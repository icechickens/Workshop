graph LR
    %% スタイル定義
    classDef aws fill:#FF9900,stroke:#232F3E,color:white
    classDef client fill:#D5E8D4,stroke:#82B366
    classDef cluster fill:#E1F5FE,stroke:#4FC3F7
    classDef vpc fill:#F5F5F5,stroke:#BDBDBD
    classDef subnet fill:#FFF9C4,stroke:#FFF176
    classDef ecsCluster fill:#E8F5E9,stroke:#81C784

    %% ノード定義
    Client[クライアント]:::client
    
    subgraph AWS["AWS クラウド"]:::cluster
        EventBridge[EventBridge<br>スケジュール]:::aws
        SQS[SQS<br>ジョブキュー]:::aws
        
        subgraph VPC["VPC"]:::vpc
            subgraph PrivateSubnet["プライベートサブネット"]:::subnet
                subgraph ECSCluster["ECS クラスター"]:::ecsCluster
                    Fargate[Fargate]:::aws
                    Container1[バッチ処理<br>コンテナ1]:::aws
                    Container2[バッチ処理<br>コンテナ2]:::aws
                    Container3[バッチ処理<br>コンテナ3]:::aws
                end
                
                RDS[RDS<br>データベース]:::aws
            end
        end
        
        S3[S3バケット<br>入出力データ]:::aws
        CloudWatch[CloudWatch<br>モニタリング]:::aws
        IAM[IAM<br>ロール]:::aws
    end
    
    %% 接続関係
    Client -->|バッチ処理<br>リクエスト| EventBridge
    EventBridge -->|スケジュール<br>トリガー| SQS
    SQS -->|ジョブ取得| Container1
    SQS -->|ジョブ取得| Container2
    SQS -->|ジョブ取得| Container3
    
    Fargate -.->|実行環境| Container1
    Fargate -.->|実行環境| Container2
    Fargate -.->|実行環境| Container3
    
    Container1 -->|データ読み書き| S3
    Container2 -->|データ読み書き| S3
    Container3 -->|データ読み書き| S3
    
    Container1 -->|データ処理| RDS
    Container2 -->|データ処理| RDS
    Container3 -->|データ処理| RDS
    
    Container1 -->|ログ/メトリクス| CloudWatch
    Container2 -->|ログ/メトリクス| CloudWatch
    Container3 -->|ログ/メトリクス| CloudWatch
    
    IAM -.->|権限付与| Container1
    IAM -.->|権限付与| Container2
    IAM -.->|権限付与| Container3
